{"is_source_file": true, "format": "Python", "description": "This file defines API endpoints for streaming music tracks, including starting and stopping streaming sessions, using FastAPI. It manages track retrieval or placeholder creation, creates streaming session records, and constructs stream URLs, primarily serving static audio files.", "external_files": ["app.db.session", "app.db.models", "app.schemas.stream", "app.dependencies"], "external_methods": ["get_db", "StreamSession", "Track", "User", "StreamStartRequest", "StreamStopRequest", "StreamStartResponse", "current_user"], "published": ["router"], "classes": [{"name": "StreamSession", "description": "Database model representing a streaming session, associated with a user and a track, with start and end times."}, {"name": "Track", "description": "Database model representing a music track, with id, title, and artist."}, {"name": "User", "description": "Database model representing a user, with at least an id."}, {"name": "StreamStartRequest", "description": "Schema for starting a stream, including trackId."}, {"name": "StreamStopRequest", "description": "Schema for stopping a stream, including sessionId."}, {"name": "StreamStartResponse", "description": "Schema for response when starting a stream, including session_id, track_id, and stream_url."}], "methods": [{"name": "start_stream(payload: StreamStartRequest, user: User = Depends(current_user), db: Session = Depends(get_db))", "description": "API endpoint to initiate a streaming session for a specified track, creating a session record, and returning stream URL and session info.", "scope": "", "scopeKind": ""}, {"name": "stop_stream(payload: StreamStopRequest, user: User = Depends(current_user), db: Session = Depends(get_db))", "description": "API endpoint to terminate a streaming session if owned by current user.", "scope": "", "scopeKind": ""}], "calls": ["db.query(Track).filter(Track.id == tid_int).first()", "db.query(Track).filter(Track.title == str(track_id)).first()", "db.add(track)", "db.flush()", "db.refresh(session)", "db.add(s)", "db.commit()", "db.query(StreamSession).filter(StreamSession.id == payload.sessionId, StreamSession.user_id == user.id).first()", "db.add(s)"], "search-terms": ["FastAPI streaming API", "music stream start endpoint", "track placeholder creation", "static audio path"], "state": 2, "file_id": 55, "knowledge_revision": 155, "git_revision": "05ef662fb570c187058fc0ae1ccec2febe13101e", "revision_history": [{"138": "05ef662fb570c187058fc0ae1ccec2febe13101e"}, {"155": "05ef662fb570c187058fc0ae1ccec2febe13101e"}], "ctags": [{"_type": "tag", "name": "STATIC_AUDIO_DIR", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/routers/stream.py", "pattern": "/^STATIC_AUDIO_DIR = Path(__file__).resolve().parents[1] \\/ \"static\" \\/ \"audio\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/routers/stream.py", "pattern": "/^router = APIRouter(prefix=\"\\/api\\/stream\", tags=[\"Streaming\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "start_stream", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/routers/stream.py", "pattern": "/^def start_stream(payload: StreamStartRequest, user: User = Depends(current_user), db: Session = /", "language": "Python", "kind": "function", "signature": "(payload: StreamStartRequest, user: User = Depends(current_user), db: Session = Depends(get_db))"}, {"_type": "tag", "name": "stop_stream", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/routers/stream.py", "pattern": "/^def stop_stream(payload: StreamStopRequest, user: User = Depends(current_user), db: Session = De/", "language": "Python", "kind": "function", "signature": "(payload: StreamStopRequest, user: User = Depends(current_user), db: Session = Depends(get_db))"}], "hash": "9acbbc89d65a2e3830747c82e1613d3b", "format-version": 4, "code-base-name": "WebFrontend", "filename": "BackendAPI/app/routers/stream.py", "fields": [{"name": "STATIC_AUDIO_DIR = Path(__file__).resolve().parents[1] \\/ \"static\" \\/ \"audio\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "router = APIRouter(prefix=\"\\/api\\/stream\", tags=[\"Streaming\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}