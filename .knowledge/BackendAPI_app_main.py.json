{"is_source_file": true, "format": "Python (FastAPI)", "description": "This file is the main entry point for a FastAPI-based music streaming backend service. It sets up the FastAPI app, configures middleware including CORS, initializes database tables, registers API routers for different functional areas (auth, playlists, catalog, recommendations, streaming, admin), and implements an endpoint for serving static audio files with Range request support. It also contains helper functions for handling range parsing and optional seeding of initial data.", "external_files": ["app/config.py", "app/db/session.py", "app/db/models.py", "app/routers/auth.py", "app/routers/playlists.py", "app/routers/catalog.py", "app/routers/recommendations.py", "app/routers/stream.py", "app/routers/admin.py", "app/security/auth.py"], "external_methods": ["get_settings()", "Base.metadata.create_all()", "SessionLocal()", "hash_password()"], "published": ["app", "serve_audio"], "classes": [], "methods": [{"name": "tuple[int,int]|None _range_parse(range_header: str, file_size: int)", "description": "Parses the HTTP Range header to determine start and end byte positions for partial content delivery.", "scope": "", "scopeKind": ""}, {"name": "serve_audio(filename: str, request: Request)", "description": "Handles GET requests to serve static audio files with support for HTTP Range requests for streaming.", "scope": "", "scopeKind": ""}, {"name": "root()", "description": "Simple health check endpoint to verify the service is running.", "scope": "", "scopeKind": ""}, {"name": "_seed_admin_and_demo()", "description": "Seeds an admin user and demo tracks in the database for local development (called at startup).", "scope": "", "scopeKind": ""}, {"name": "full_iter()", "scope": "serve_audio", "scopeKind": "function", "description": "unavailable"}, {"name": "range_iter(start_pos: int, end_pos: int)", "scope": "serve_audio", "scopeKind": "function", "description": "unavailable"}], "calls": ["FastAPI()", "app.add_middleware()", "Base.metadata.create_all()", "app.include_router()", "Path().resolve()", "os.makedirs()", "Path.exists()", "Path.write_text()", "_range_parse()", "request.headers.get()", "file_path.exists()", "file_path.is_file()", "file_path.stat().st_size", "SessionLocal()", "db.query()", "db.add()", "db.commit()", "Track()", "User()"], "search-terms": ["static audio streaming", "Range header parsing", "FastAPI static file serving", "audio file directory", "initial database seed", "music streaming backend", "app routers", "CORS configuration"], "state": 2, "file_id": 57, "knowledge_revision": 154, "git_revision": "05ef662fb570c187058fc0ae1ccec2febe13101e", "revision_history": [{"141": "05ef662fb570c187058fc0ae1ccec2febe13101e"}, {"154": "05ef662fb570c187058fc0ae1ccec2febe13101e"}], "ctags": [{"_type": "tag", "name": "AUDIO_DIR", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^AUDIO_DIR = Path(__file__).resolve().parent.parent \\/ \"static\" \\/ \"audio\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "README_NOTE", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^README_NOTE = AUDIO_DIR.parent \\/ \"README.txt\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_range_parse", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^def _range_parse(range_header: str, file_size: int) -> tuple[int, int] | None:$/", "language": "Python", "typeref": "typename:tuple[int,int]|None", "kind": "function", "signature": "(range_header: str, file_size: int)"}, {"_type": "tag", "name": "_seed_admin_and_demo", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^def _seed_admin_and_demo():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "admin_router", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^from app.routers import admin as admin_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:admin"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "auth_router", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^from app.routers import auth as auth_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:auth"}, {"_type": "tag", "name": "catalog_router", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^from app.routers import catalog as catalog_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:catalog"}, {"_type": "tag", "name": "cors_origins", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^cors_origins = settings.cors_origin_list()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "full_iter", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^        def full_iter():$/", "file": true, "language": "Python", "kind": "function", "signature": "()", "scope": "serve_audio", "scopeKind": "function"}, {"_type": "tag", "name": "playlists_router", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^from app.routers import playlists as playlists_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:playlists"}, {"_type": "tag", "name": "range_iter", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^    def range_iter(start_pos: int, end_pos: int):$/", "file": true, "language": "Python", "kind": "function", "signature": "(start_pos: int, end_pos: int)", "scope": "serve_audio", "scopeKind": "function"}, {"_type": "tag", "name": "recommendations_router", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^from app.routers import recommendations as recommendations_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:recommendations"}, {"_type": "tag", "name": "root", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^def root():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "serve_audio", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^def serve_audio(filename: str, request: Request):$/", "language": "Python", "kind": "function", "signature": "(filename: str, request: Request)"}, {"_type": "tag", "name": "settings", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^settings = get_settings()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "stream_router", "path": "/home/kavia/workspace/code-generation/music-streaming-service-21915-22054/BackendAPI/app/main.py", "pattern": "/^from app.routers import stream as stream_router$/", "language": "Python", "kind": "unknown", "nameref": "unknown:stream"}], "hash": "04a7256c8e4112527f31fab10d3a61ef", "format-version": 4, "code-base-name": "WebFrontend", "filename": "BackendAPI/app/main.py", "fields": [{"name": "AUDIO_DIR = Path(__file__).resolve().parent.parent \\/ \"static\" \\/ \"audio\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "README_NOTE = AUDIO_DIR.parent \\/ \"README.txt\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "cors_origins = settings.cors_origin_list()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "settings = get_settings()", "scope": "", "scopeKind": "", "description": "unavailable"}]}